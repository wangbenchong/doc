# SDF概述

**SDF（Signed Distance Field，有向距离场）** 是一种在图形学中广泛使用的数学表示方法，尤其在实时渲染、程序化建模和字体渲染中具有显著优势。以下是其核心特点和优势：

------

## SDF的核心特点

1. **距离信息存储**
   - SDF不仅存储几何形状的边界，还记录空间中任意点到边界的**最短距离**，并区分**内部（负值）\**和\**外部（正值）**。
   - **示例**：一个半径为1的球体，其SDF在球心处的值为`-1`，外部某点距离球心2单位时值为`1`。
2. **隐式几何表示**
   - 传统网格（Mesh）显式存储顶点和面，而SDF通过数学函数隐式定义形状，**无需存储拓扑结构**，适合描述复杂或动态变化的几何体。
3. **分辨率无关性**
   - SDF可以无限缩放而不失真（如矢量图形），而位图（如PNG）放大后会像素化。
4. **支持布尔运算**
   - 通过简单数学操作（如`max/min`）即可实现**并集（Union）、差集（Subtract）、交集（Intersect）**，无需处理网格布尔运算的复杂拓扑问题。

------

## SDF的核心优势

### 高性能实时渲染

- **抗锯齿**：SDF边缘可通过距离场平滑插值，避免锯齿（Aliasing），尤其适合字体和UI渲染。
- **高效碰撞检测**：直接比较距离值即可判断碰撞（如`if(distance < 0)`）。
- **GPU友好**：SDF计算通常是并行化的数学运算，适合着色器处理。

### 灵活的建模能力

- **程序化生成**：通过数学函数（如噪声、分形）动态生成复杂形状（如云层、地形）。
- **动态变形**：修改距离场函数即可实时变形几何体（如融化、膨胀效果）。

### 低存储开销

- 传统3D网格需存储大量顶点数据，而SDF只需一个距离函数或低分辨率3D纹理（如3D游戏中的体积雾）。

### 跨领域应用

- **字体渲染**（如Unity的TextMesh Pro、游戏引擎的矢量字体）。
- **VFX特效**（如粒子碰撞、流体模拟）。
- **光线步进（Ray Marching）**：用于实时光线追踪中的体积渲染（如烟雾、火焰）。

------

## SDF的局限性

1. **计算复杂度**
   - 复杂形状的SDF可能需要高精度计算（如解析式SDF），对性能有挑战。
2. **细节丢失**
   - 低分辨率SDF纹理（如3D纹理存储的距离场）可能导致细节模糊。
3. **不适合所有场景**
   - 超精细的机械模型仍依赖传统网格，因SDF难以表达微观结构（如螺纹、齿轮）。

------

## 典型应用案例

1. **游戏中的字体渲染**

   - SDF字体只需单张纹理存储距离场，缩放任意大小仍保持锐利边缘。
   
2. **Shader中的程序化建模**

   - 通过SDF布尔运算生成复杂几何体（如科幻场景中的未来建筑）。

   ```glsl
   // 示例：两个球体的差集（Subtract）
   float sdf = max(sphereSDF(pos, center1, radius1), -sphereSDF(pos, center2, radius2));
   ```

3. **VFX特效**

   - 用SDF定义粒子碰撞区域或变形场（如《塞尔达传说》中的魔法效果）。

------

## 总结s

SDF的优势在于**数学简洁性、实时性能强、动态灵活性**，尤其适合需要抗锯齿、动态变形或程序化生成的场景。尽管不适用于所有高精度模型，但在游戏开发、影视特效和UI渲染中已成为不可或缺的工具。

# SDF Subtract

在图形编程和Shader中，**"SDF Subtract"** 是 **有向距离场（Signed Distance Field, SDF）** 的一种布尔运算操作，表示 **“减法”** 或 **“差集”**。其作用是从一个SDF形状中“减去”另一个SDF形状，形成组合效果。以下是具体解释：

------

## 数学定义

- **SDF Subtract** 的公式通常表示为：

  ```
  result = max(sdf_A, -sdf_B)
  ```
  
  - `sdf_A`：基础形状的距离场。
  - `sdf_B`：被减去的形状的距离场。
  - `-sdf_B`：对`B`取反，表示“外部”区域。
  - `max`：保留`A`和`B`反相后的重叠部分（即`A`减去`B`的区域）。

------

## 直观效果

- **几何意义**：用形状`B`在形状`A`上“挖洞”。
  - 例如：从一个立方体（`A`）中减去一个球体（`B`），会形成一个带球形凹陷的立方体。

------

## 在ShaderGraph中的应用

- **节点名称**：在Unity ShaderGraph或类似工具中，可能直接命名为 **`SDF Subtract`** 或 **`Boolean Subtract`**。
- **输入输出**：
  - **输入**：两个SDF形状（如两个`SDF Sphere`节点）。
  - **输出**：减法后的新SDF。
- **常见用途**：
  - 创建复杂几何（如带孔洞的物体）。
  - 结合其他SDF操作（如Union/Intersect）生成自定义形状。

------

## 代码实现示例（HLSL）

```glsl
// SDF Subtract操作
float SDFSubtract(float sdfA, float sdfB) {
    return max(sdfA, -sdfB);
}
```

------

##  相关术语

- **SDF Union（并集）**：`min(sdf_A, sdf_B)`
- **SDF Intersect（交集）**：`max(sdf_A, sdf_B)`
- **SDF Smooth Subtract（平滑减法）**：通过平滑函数（如`smoothmax`）实现柔和的过渡边缘。

------

## 总结

- **SDF Subtract = 形状A - 形状B**，即用`B`在`A`上“挖洞”。
- 是SDF建模中基础的布尔运算之一，常用于程序化生成复杂几何体。



# SDF图的生成

## 2D纹理

【距离场生成插件2D】 [距离场生成插件2D_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV19L4y1j7mb)

## 3D纹理

可使用VFX插件提供的工具来生成：SDF Bake Tool

